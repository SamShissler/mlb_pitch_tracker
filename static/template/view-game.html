{%extends "base.html"%}

{%block title%}{{away}} at {{home}} on {{month}}/{{day}}/{{year}}{%endblock%}
{%block extrastyle%}
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<link href="/css/game-view.css" rel="stylesheet">
{%endblock%}

{%block body%}
   <div class="container">
       <h1>{{away}} at {{home}}</h1>
       <div class="panel-group" id="accordion_innings">
       {%for inning in game_data['innings']%}
           {%set inning_num = loop.index%}
           <div class="panel panel-default">
               <div class="panel-heading">
                   <h2 class="panel-title">
                       <a data-toggle="collapse" data-parent="#accordion_innings" href="#{{game_id}}-{{inning_num}}">
                           Inning {{loop.index}}
                       </a>
                   </h2>
               </div>
               <div id="{{game_id}}-{{inning_num}}" class="panel-collapse collapse">
                   <div class="panel-group" id="accordion_t{{inning_num}}">
                       <div class="header">
                           <h2 class="panel-heading">
                               <a data-toggle="collapse" data-parent="#accordion_t{{inning_num}}" href="#{{game_id}}-t{{inning_num}}">
                                   Top
                               </a>
                           </h2>
                       </div>
                       <div id="{{game_id}}-t{{inning_num}}" class="panel-collapse collapse">
                       {%for atbat in inning['top']%}
                           <div class="atbat_container">
                               <h4>
                                   {{game_data['away']['players'][atbat['batter']]['first']}}
                                   {{game_data['away']['players'][atbat['batter']]['last']}}
                                    hitting against
                                   {{game_data['home']['players'][atbat['pitcher']]['first']}}
                                   {{game_data['home']['players'][atbat['pitcher']]['last']}}
                               </h4>
                               <div class="atbat">
                                   <div class="pitches">
                                       {{atbat['pitches']}}
                                   </div>
                                   <canvas id="{{game_id}}-t{{inning_num}}-{{loop.index}}" width="100" height="100" class="strikezone"></canvas>
                               </div>
                           </div>
                       {%endfor%}
                       </div>
                   </div>
                   <div class="panel-group" id="accordion_b{{inning_num}}">
                       <div class="header">
                           <h2 class="panel-heading">
                               <a data-toggle="collapse" data-parent="#accordion_b{{inning_num}}" href="#{{game_id}}-b{{inning_num}}">
                                   Bottom
                               </a>
                           </h2>
                       </div>
                       <div id="{{game_id}}-b{{inning_num}}" class="panel-collapse collapse">
                       {%for atbat in inning['bottom']%}
                           <div class="atbat_container">
                               <h4>
                                   {{game_data['home']['players'][atbat['batter']]['first']}}
                                   {{game_data['home']['players'][atbat['batter']]['last']}}
                                    hitting against
                                   {{game_data['away']['players'][atbat['pitcher']]['first']}}
                                   {{game_data['away']['players'][atbat['pitcher']]['last']}}
                               </h4>
                               <div class="atbat">
                                   <div class="pitches">
                                       {{atbat['pitches']}}
                                   </div>
                                   <canvas id="{{game_id}}-b{{inning_num}}-{{loop.index}}" width="100" height="100" class="strikezone"></canvas>
                               </div>
                           </div>
                       {%endfor%}
                       </div>
                   </div>
                </div>
            </div>
       {%endfor%}
       </div>
   </div>
{%endblock%}
{% block extrascripts %}
<script src="/js/draw_strikezone.js"></script>
<script type="text/javascript">
    var pitches = {{game_data['innings'][-1]['top'][0]['pitches'] | safe}};
    draw_strikezone(
            "{{game_id}}-t1-1",
            pitches
    );
</script>
{% endblock %}
